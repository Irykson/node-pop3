{"version":3,"file":"Command.js","names":["value","then","direct","Promise","resolve","Pop3Command","user","password","host","port","tls","timeout","tlsOptions","servername","_PASSInfo","_socket","info","msgNumber","_connect","stream","stream2String","str","list","listify","n","Pop3Connection"],"sources":["../src/Command.mjs"],"sourcesContent":["import Pop3Connection from './Connection.mjs';\n\nimport { stream2String, listify } from './helper.mjs';\n\nclass Pop3Command extends Pop3Connection {\n  constructor({\n    user,\n    password,\n    host,\n    port,\n    tls,\n    timeout,\n    tlsOptions,\n    servername\n  }) {\n    super({ host, port, tls, timeout, tlsOptions, servername });\n    this.user = user;\n    this.password = password;\n    this._PASSInfo = '';\n  }\n\n  async _connect() {\n    if (this._socket) {\n      return this._PASSInfo;\n    }\n    await super.connect();\n    await super.command('USER', this.user);\n    const [info] = await super.command('PASS', this.password);\n    this._PASSInfo = info;\n    return this._PASSInfo;\n  }\n\n  async UIDL(msgNumber = '') {\n    await this._connect();\n    const [, stream] = await super.command('UIDL', msgNumber);\n    const str = await stream2String(stream);\n    const list = listify(str);\n    return msgNumber ? list[0] : list;\n  }\n\n  async NOOP() {\n    await this._connect();\n    await super.command('NOOP');\n    return;\n  }\n\n  async LIST(msgNumber = '') {\n    await this._connect();\n    const [, stream] = await super.command('LIST', msgNumber);\n    const str = await stream2String(stream);\n    const list = listify(str);\n    return msgNumber ? list[0] : list;\n  }\n\n  async RSET() {\n    await this._connect();\n    const [info] = await super.command('RSET');\n    return info;\n  }\n\n  async RETR(msgNumber) {\n    await this._connect();\n    const [, stream] = await super.command('RETR', msgNumber);\n    return stream2String(stream);\n  }\n\n  async DELE(msgNumber) {\n    await this._connect();\n    const [info] = await super.command('DELE', msgNumber);\n    return info;\n  }\n\n  async STAT() {\n    await this._connect();\n    const [info] = await super.command('STAT');\n    return info;\n  }\n\n  async TOP(msgNumber, n = 0) {\n    await this._connect();\n    const [, stream] = await super.command('TOP', msgNumber, n);\n    return stream2String(stream);\n  }\n\n  async QUIT() {\n    if (!this._socket) {\n      this._PASSInfo = '' || 'Bye';\n      return this._PASSInfo;\n    }\n    const [info] = await super.command('QUIT');\n    this._PASSInfo = info || '';\n    return this._PASSInfo;\n  }\n}\n\nPop3Command.stream2String = stream2String;\nPop3Command.listify = listify;\n\nexport default Pop3Command;\n"],"mappings":";;;;;;;AAAA;AAEA;AAAsD;AAkF/C,gBAAgBA,KAAK,EAAEC,IAAI,EAAEC,MAAM,EAAE;EAC3C,IAAIA,MAAM,EAAE;IACX,OAAOD,IAAI,GAAGA,IAAI,CAACD,KAAK,CAAC,GAAGA,KAAK;EAClC;EACA,IAAI,CAACA,KAAK,IAAI,CAACA,KAAK,CAACC,IAAI,EAAE;IAC1BD,KAAK,GAAGG,OAAO,CAACC,OAAO,CAACJ,KAAK,CAAC;EAC/B;EACA,OAAOC,IAAI,GAAGD,KAAK,CAACC,IAAI,CAACA,IAAI,CAAC,GAAGD,KAAK;AACvC;AAogBO,kBAAkB,CACzB;AAlgBO,uBAAuBA,KAAK,EAAEE,MAAM,EAAE;EAC5C,IAAI,CAACA,MAAM,EAAE;IACZ,OAAOF,KAAK,IAAIA,KAAK,CAACC,IAAI,GAAGD,KAAK,CAACC,IAAI,QAAQ,GAAGE,OAAO,CAACC,OAAO,EAAE;EACpE;AACD;AAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA/FKC,WAAW;EAAA;EAAA;EACf,2BASG;IAAA;IAAA,IARDC,IAAI,QAAJA,IAAI;MACJC,QAAQ,QAARA,QAAQ;MACRC,IAAI,QAAJA,IAAI;MACJC,IAAI,QAAJA,IAAI;MACJC,GAAG,QAAHA,GAAG;MACHC,OAAO,QAAPA,OAAO;MACPC,UAAU,QAAVA,UAAU;MACVC,UAAU,QAAVA,UAAU;IAAA;IAEV,0BAAM;MAAEL,IAAI,EAAJA,IAAI;MAAEC,IAAI,EAAJA,IAAI;MAAEC,GAAG,EAAHA,GAAG;MAAEC,OAAO,EAAPA,OAAO;MAAEC,UAAU,EAAVA,UAAU;MAAEC,UAAU,EAAVA;IAAW,CAAC;IAC1D,MAAKP,IAAI,GAAGA,IAAI;IAChB,MAAKC,QAAQ,GAAGA,QAAQ;IACxB,MAAKO,SAAS,GAAG,EAAE;IAAC;EACtB;EAAC;IAAA;IAAA;MAAA,IAEgB;QAAA,aACX,IAAI;QAAR,IAAI,OAAKC,OAAO,EAAE;UAChB,cAAO,OAAKD,SAAS;QACvB;QAAC;UAAA,2FAEmB,MAAM,EAAE,OAAKR,IAAI;YAAA,2FACF,MAAM,EAAE,OAAKC,QAAQ;cAAA;gBAAjDS,IAAI;cACX,OAAKF,SAAS,GAAGE,IAAI;cACrB,OAAO,OAAKF,SAAS;YAAC;UAAA;QAAA;MACxB,CAAC;QAAA;MAAA;IAAA;EAAA;IAAA;IAAA;MAAA,IAEUG,SAAS,uEAAG,EAAE;MAAA,IAAE;QAAA,aACnB,IAAI;QAAA,cAAJ,OAAKC,QAAQ,EAAE;UAAA,2FACkB,MAAM,EAAED,SAAS;YAAA;cAA/CE,MAAM;YAAA,cACG,IAAAC,qBAAa,EAACD,MAAM,CAAC,YAAjCE,GAAG;cACT,IAAMC,IAAI,GAAG,IAAAC,eAAO,EAACF,GAAG,CAAC;cACzB,OAAOJ,SAAS,GAAGK,IAAI,CAAC,CAAC,CAAC,GAAGA,IAAI;YAAC;UAAA;QAAA;MACpC,CAAC;QAAA;MAAA;IAAA;EAAA;IAAA;IAAA;MAAA,IAEY;QAAA,aACL,IAAI;QAAA,cAAJ,OAAKJ,QAAQ,EAAE;UAAA,kGACD,MAAM;QAAA;MAE5B,CAAC;QAAA;MAAA;IAAA;EAAA;IAAA;IAAA;MAAA,IAEUD,SAAS,uEAAG,EAAE;MAAA,IAAE;QAAA,aACnB,IAAI;QAAA,cAAJ,OAAKC,QAAQ,EAAE;UAAA,2FACkB,MAAM,EAAED,SAAS;YAAA;cAA/CE,MAAM;YAAA,cACG,IAAAC,qBAAa,EAACD,MAAM,CAAC,YAAjCE,GAAG;cACT,IAAMC,IAAI,GAAG,IAAAC,eAAO,EAACF,GAAG,CAAC;cACzB,OAAOJ,SAAS,GAAGK,IAAI,CAAC,CAAC,CAAC,GAAGA,IAAI;YAAC;UAAA;QAAA;MACpC,CAAC;QAAA;MAAA;IAAA;EAAA;IAAA;IAAA;MAAA,IAEY;QAAA,cACL,IAAI;QAAA,cAAJ,QAAKJ,QAAQ,EAAE;UAAA,6FACc,MAAM;YAAA;cAAlCF,IAAI;YACX,OAAOA,IAAI;UAAC;QAAA;MACd,CAAC;QAAA;MAAA;IAAA;EAAA;IAAA;IAAA,qBAEUC,SAAS;MAAA,IAAE;QAAA,cACd,IAAI;QAAA,cAAJ,QAAKC,QAAQ,EAAE;UAAA,6FACkB,MAAM,EAAED,SAAS;YAAA;cAA/CE,MAAM;YACf,OAAO,IAAAC,qBAAa,EAACD,MAAM,CAAC;UAAC;QAAA;MAC/B,CAAC;QAAA;MAAA;IAAA;EAAA;IAAA;IAAA,qBAEUF,SAAS;MAAA,IAAE;QAAA,cACd,IAAI;QAAA,cAAJ,QAAKC,QAAQ,EAAE;UAAA,6FACc,MAAM,EAAED,SAAS;YAAA;cAA7CD,IAAI;YACX,OAAOA,IAAI;UAAC;QAAA;MACd,CAAC;QAAA;MAAA;IAAA;EAAA;IAAA;IAAA;MAAA,IAEY;QAAA,cACL,IAAI;QAAA,cAAJ,QAAKE,QAAQ,EAAE;UAAA,6FACc,MAAM;YAAA;cAAlCF,IAAI;YACX,OAAOA,IAAI;UAAC;QAAA;MACd,CAAC;QAAA;MAAA;IAAA;EAAA;IAAA;IAAA,oBAESC,SAAS;MAAA,IAAEO,CAAC,uEAAG,CAAC;MAAA,IAAE;QAAA,cACpB,IAAI;QAAA,cAAJ,QAAKN,QAAQ,EAAE;UAAA,6FACkB,KAAK,EAAED,SAAS,EAAEO,CAAC;YAAA;cAAjDL,MAAM;YACf,OAAO,IAAAC,qBAAa,EAACD,MAAM,CAAC;UAAC;QAAA;MAC/B,CAAC;QAAA;MAAA;IAAA;EAAA;IAAA;IAAA;MAAA,IAEY;QAAA,cACN,IAAI;QAAT,IAAI,CAAC,QAAKJ,OAAO,EAAE;UACjB,QAAKD,SAAS,GAAG,EAAE,IAAI,KAAK;UAC5B,cAAO,QAAKA,SAAS;QACvB;QAAC,6FACkC,MAAM;UAAA;YAAlCE,IAAI;UACX,QAAKF,SAAS,GAAGE,IAAI,IAAI,EAAE;UAC3B,OAAO,QAAKF,SAAS;QAAC;MACxB,CAAC;QAAA;MAAA;IAAA;EAAA;EAAA;AAAA,EAxFuBW,sBAAc;AA2FxCpB,WAAW,CAACe,aAAa,GAAGA,qBAAa;AACzCf,WAAW,CAACkB,OAAO,GAAGA,eAAO;AAAC,eAEflB,WAAW;AAAA;AAAA"}